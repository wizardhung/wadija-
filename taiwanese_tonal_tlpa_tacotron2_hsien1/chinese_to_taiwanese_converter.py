# -*- coding: utf-8 -*-
"""
華文字轉台語漢字預處理模組
將現代華語用字轉換為台語常用漢字
"""

from typing import List, Tuple


class ChineseToTaiwaneseConverter:
    """華文字轉台語漢字轉換器"""
    
    def __init__(self):
        self.conversion_dict = self._build_conversion_dict()
    
    def _build_conversion_dict(self) -> dict:
        """建立華文字轉台語漢字的對照表"""
        return {
            # 常用動詞
            '吃': '食',
            '喝': '飲', 
            '走': '行',
            '跑': '走',
            '睡覺': '睏',
            '睡': '睏',
            '說': '講',
            '說話': '講話',
            '聊天': '開講',
            '看': '看',
            '看見': '看著',
            '聽': '聽',
            '聽見': '聽著',
            '做': '做',
            '工作': '做工',
            '上班': '做工',
            '買': '買',
            '賣': '賣',
            '來': '來',
            '去': '去',
            '回家': '轉去',
            '回來': '轉來',
            '進來': '入來',
            '出去': '出去',
            '起床': '起床',
            '起來': '起來',
            '坐下': '坐落來',
            '站起來': '徛起來',
            '躺下': '躺落去',
            
            # 形容詞
            '漂亮': '媠',
            '美麗': '媠',
            '好看': '媠',
            '醜': '醜',
            '醜陋': '醜',
            '不好看': '無媠',
            '大': '大',
            '小': '細',
            '高': '懸',
            '矮': '低',
            '胖': '肥',
            '瘦': '瘦',
            '長': '長',
            '短': '短',
            '新': '新',
            '舊': '舊',
            '乾淨': '清氣',
            '髒': '垃圾',
            '熱': '熱',
            '冷': '冷',
            '溫暖': '燒',
            '涼': '涼',
            '甜': '甜',
            '苦': '苦',
            '酸': '酸',
            '辣': '辣',
            '鹹': '鹹',
            '好吃': '好食',
            '難吃': '歹食',
            
            # 量詞和單位
            '個': '个',
            '隻': '隻',
            '條': '條',
            '張': '張',
            '本': '本',
            '支': '支',
            '台': '台',
            '輛': '台',
            '部': '部',
            '件': '件',
            '雙': '雙',
            '對': '對',
            '副': '副',
            '套': '套',
            
            # 時間詞
            '現在': '這馬',
            '今天': '今仔日',
            '昨天': '昨日',
            '明天': '明仔日',
            '後天': '後日',
            '前天': '前日',
            '早上': '早起',
            '中午': '中晝',
            '下午': '下晡',
            '晚上': '暗時',
            '夜晚': '暗時',
            '半夜': '半暝',
            '白天': '日時',
            '上午': '頂晡',
            '傍晚': '黃昏',
            '年': '年',
            '月': '月',
            '日': '日',
            '天': '工',
            '小時': '點鐘',
            '分鐘': '分',
            '秒': '秒',
            '星期': '拜',
            '禮拜': '拜',
            '週': '拜',
            
            # 方位詞
            '這裡': '遮',
            '那裡': '遐',
            '哪裡': '佗位',
            '裡面': '內面',
            '外面': '外面',
            '上面': '頂面',
            '下面': '下面',
            '前面': '頭前',
            '後面': '後壁',
            '旁邊': '邊仔',
            '中間': '中央',
            '左邊': '倒爿',
            '右邊': '正爿',
            '東邊': '東爿',
            '西邊': '西爿',
            '南邊': '南爿',
            '北邊': '北爿',
            
            # 人稱和稱謂
            '我們': '阮',
            '你們': '恁',
            '他們': 'in',
            '她們': 'in',
            '它們': 'in',
            '爺爺': '阿公',
            '奶奶': '阿嬤',
            '爸爸': '阿爸',
            '媽媽': '阿母',
            '哥哥': '阿兄',
            '姐姐': '阿姊',
            '弟弟': '小弟',
            '妹妹': '小妹',
            '兒子': '囝仔',
            '女兒': '查某囝',
            '老公': '翁婿',
            '老婆': '某',
            '丈夫': '翁婿',
            '妻子': '某',
            '朋友': '朋友',
            '同學': '同學',
            '老師': '先生',
            '學生': '學生',
            '醫生': '醫生',
            '護士': '護士',
            '警察': '警察',
            
            # 身體部位
            '頭': '頭',
            '臉': '面',
            '眼睛': '目睭',
            '耳朵': '耳仔',
            '鼻子': '鼻仔',
            '嘴巴': '喙',
            '牙齒': '齒',
            '舌頭': '舌',
            '脖子': '頷頸',
            '肩膀': '肩胛',
            '手': '手',
            '腳': '跤',
            '肚子': '腹肚',
            '背': '背脊',
            '屁股': '尻川',
            '心臟': '心肝',
            '肺': '肺',
            
            # 食物
            '米飯': '飯',
            '麵條': '麵條',
            '麵包': '麵包',
            '肉': '肉',
            '豬肉': '豬肉',
            '牛肉': '牛肉',
            '雞肉': '雞肉',
            '魚': '魚仔',
            '蝦': '蝦仔',
            '蟹': '蟳仔',
            '蛋': '卵',
            '雞蛋': '雞卵',
            '牛奶': '牛奶',
            '水': '水',
            '茶': '茶',
            '咖啡': '咖啡',
            '果汁': '果子汁',
            '啤酒': '啤酒',
            '白酒': '米酒',
            '紅酒': '葡萄酒',
            
            # 生活用品
            '衣服': '衫',
            '褲子': '褲',
            '鞋子': '鞋',
            '帽子': '帽仔',
            '包包': '皮包',
            '手機': '手機仔',
            '電腦': '電腦',
            '電視': '電視',
            '冰箱': '雪櫃',
            '洗衣機': '洗衫機',
            '汽車': '汽車',
            '機車': '機車',
            '腳踏車': '鐵馬',
            '公車': '公車',
            '捷運': '捷運',
            '火車': '火車',
            '飛機': '飛行機',
            
            # 地點
            '家': '厝',
            '房子': '厝',
            '學校': '學校',
            '醫院': '醫院',
            '銀行': '銀行',
            '郵局': '郵局',
            '警察局': '派出所',
            '火車站': '火車頭',
            '機場': '飛行場',
            '商店': '店',
            '超市': '超級市場',
            '餐廳': '飯店',
            '咖啡店': '咖啡店',
            '公園': '公園',
            '圖書館': '圖書館',
            '廁所': '便所',
            
            # 感嘆詞和語氣詞
            '啊': '啊',
            '哦': '喔',
            '嗯': 'nnh',
            '是的': '是',
            '對': '著',
            '不對': '毋著',
            '好': '好',
            '不好': '毋好',
            '可以': '會使',
            '不可以': '袂使',
            '要': '愛',
            '不要': '毋愛',
            '有': '有',
            '沒有': '無',
            '是': '是',
            '不是': '毋是',
            
            # 疑問詞
            '什麼': '啥物',
            '誰': '啥人',
            '哪個': '佗一个',
            '怎麼': '按怎',
            '為什麼': '為啥物',
            '什麼時候': '啥物時陣',
            '多少': '若濟',
            '幾個': '幾个',
            '哪裡': '佗位',
            '怎麼樣': '按怎樣',
            
            # 醫療相關
            '生病': '病',
            '感冒': '感冒',
            '發燒': '發燒',
            '咳嗽': '咳',
            '頭痛': '頭疼',
            '肚子痛': '腹肚疼',
            '牙痛': '齒疼',
            '看醫生': '看醫生',
            '吃藥': '食藥',
            '打針': '注射',
            '住院': '住院',
            '開刀': '開刀',
            '檢查': '檢查',
            '體檢': '健康檢查',
            '藥': '藥',
            '藥水': '藥水',
            '藥丸': '藥丸仔',
            '醫院': '醫院',
            '診所': '診所',
            '急診': '急診',
            '救護車': '救護車',
            
            # 情感表達
            '高興': '歡喜',
            '快樂': '快活',
            '開心': '歡喜',
            '難過': '傷心',
            '生氣': '受氣',
            '害怕': '驚',
            '擔心': '操煩',
            '希望': '希望',
            '愛': '疼',
            '喜歡': '愛',
            '討厭': '厭',
            '想念': '想',
            '思念': '想',
            '感謝': '感謝',
            '對不起': '歹勢',
            '不好意思': '歹勢',
            '沒關係': '無要緊',
            
            # 數字相關（已經在基本字典中，但這裡提供一些特殊情況）
            '兩': '兩',
            '二': '兩',  # 在某些情況下
            '幾': '幾',
            '多少': '偌濟',
            '很多': '濟濟',
            '一點': '一寡',
            '一些': '一寡',
            
            # 程度副詞
            '很': '足',
            '非常': '足',
            '特別': '特別',
            '比較': '較',
            '最': '上',
            '太': '傷',
            '有點': '有小可',
            '一點點': '一寡仔',
            
            # 連接詞
            '和': '佮',
            '跟': '佮',
            '與': '佮',
            '或': '抑是',
            '還是': '抑是',
            '但是': '毋過',
            '可是': '毋過',
            '不過': '毋過',
            '所以': '所以',
            '因為': '因為',
            '如果': '若是',
            '要是': '若是',
            '雖然': '雖然',
            '雖說': '雖然講',
            
            # 常用片語
            '沒關係': '無要緊',
            '不要緊': '無要緊',
            '怎麼辦': '按怎辦',
            '算了': '算了',
            '隨便': '隨在',
            '當然': '當然',
            '真的': '真正',
            '假的': '假',
            '一定': '一定著',
            '應該': '應該',
            '可能': '可能',
            '也許': '可能',
            '或許': '可能',
            '大概': '大概',
            '差不多': '差不多',
            '剛好': '拄好',
            '剛才': '拄才',
            '剛剛': '拄拄',
            '等一下': '等一寡',
            '等等': '等等',
            '再見': '再會',
            '拜拜': '再會',
            '謝謝': '多謝',
            '不客氣': '毋免',
        }
    
    def convert(self, text: str) -> str:
        """
        轉換華文字為台語漢字
        
        Args:
            text: 輸入的華文字文本
            
        Returns:
            轉換後的台語漢字文本
        """
        result = text
        
        # 按照詞長從長到短排序，避免部分匹配問題
        sorted_items = sorted(self.conversion_dict.items(), key=lambda x: len(x[0]), reverse=True)
        
        for chinese_word, taiwanese_word in sorted_items:
            result = result.replace(chinese_word, taiwanese_word)
        
        return result
    
    def add_custom_mapping(self, chinese_word: str, taiwanese_word: str):
        """添加自訂對照"""
        self.conversion_dict[chinese_word] = taiwanese_word
    
    def get_suggestions(self, text: str) -> List[Tuple[str, str]]:
        """獲取可能的轉換建議"""
        suggestions = []
        for chinese_word, taiwanese_word in self.conversion_dict.items():
            if chinese_word in text:
                suggestions.append((chinese_word, taiwanese_word))
        return suggestions

# 測試函數
def test_converter():
    """測試轉換器功能"""
    converter = ChineseToTaiwaneseConverter()
    
    test_cases = [
        "你好，我今天吃了很多好吃的東西",
        "爺爺，你有沒有吃藥？",
        "我想要去看醫生",
        "這個很漂亮，但是太貴了",
        "我們明天要去學校上課",
        "媽媽在廚房煮飯，很香呢！",
        "弟弟跑得很快，比哥哥還要快",
        "晚上我們一起看電視吧",
    ]
    
    print("華文字轉台語漢字測試：")
    print("=" * 50)
    
    for test_text in test_cases:
        converted = converter.convert(test_text)
        print(f"原文：{test_text}")
        print(f"轉換：{converted}")
        print("-" * 30)

if __name__ == "__main__":
    test_converter()